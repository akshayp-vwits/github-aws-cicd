version: 0.2

phases:
  install:
    runtime-versions:
      nodejs: 12
      java: corretto8
  pre_build:
    commands:
      - echo Entered Pre Build Stage
      - set -e -u -x
      - cd ./cdk
      - npm install
      - npm install -g typescript
  build:
    commands:
      - echo Entered Build Stage
      - echo Build Started
      - npm run build
      - npx cdk synth
      - cd ..
      - mkdir artifacts
      - cp ./buildspec.yml artifacts
      - cp ./deployspec.yml artifacts
      - cp -R ./cdk/cdk.out artifacts
artifacts:
  files:
    - ./artifacts/**/*
